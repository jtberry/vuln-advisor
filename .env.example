# VulnAdvisor -- Environment Variables
# Copy this file to .env and fill in values as needed.
# The core tool requires NO API keys -- all data sources are free.
#
# Walk phase (API + web UI) requires the settings below.
# .env is gitignored -- never commit real secrets.

# ===========================================================================
# Core (CLI -- no API key needed)
# ===========================================================================

# NVD API key -- optional but recommended for higher rate limits (50 req/30s vs 5 req/30s)
# Get yours at: https://nvd.nist.gov/developers/request-an-api-key
NVD_API_KEY=

# Reserved for future paid/AI-enhanced features:
# ANTHROPIC_API_KEY=your-key-here

# ===========================================================================
# Walk Phase -- API server and web UI
# ===========================================================================

# Set to true for local development. Enables:
#   - Auto-generated SECRET_KEY (with warning in logs)
#   - More verbose error output
# Never set DEBUG=true in production.
DEBUG=false

# Required in production. Generate a strong key with:
#   python3 -c "import secrets; print(secrets.token_hex(32))"
# Must be at least 32 characters. Changing this invalidates all existing
# sessions and API keys (they are signed with this key).
#
# EXAMPLE VALUE -- do not use this; generate your own:
# SECRET_KEY=a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2
SECRET_KEY=

# ===========================================================================
# Auth
# ===========================================================================

# Set to true when running behind HTTPS. Makes auth cookies require TLS.
# Always true in production; leave false for local HTTP development.
SECURE_COOKIES=false

# Default session duration in seconds for new users.
# Users can override this in their settings (1h / 4h / 8h options).
#   3600  = 1 hour (default, most secure)
#   14400 = 4 hours (shift-based work)
#   28800 = 8 hours (full shift)
TOKEN_EXPIRE_SECONDS=3600

# ===========================================================================
# OAuth Providers (optional)
# ===========================================================================
# Leave empty (or omit) to disable a provider.
# Both client ID and secret must be set for a provider to be enabled.
# Admin can further toggle providers on/off from the admin settings page.

# GitHub OAuth App
# Create at: https://github.com/settings/developers -> OAuth Apps
# Callback URL: http://localhost:8000/login/callback/github
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# Google OAuth2
# Create at: https://console.cloud.google.com -> APIs & Services -> Credentials
# Callback URL: http://localhost:8000/login/callback/google
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# Generic OIDC (Okta, Azure AD, Keycloak, Authentik, etc.)
# Callback URL: http://localhost:8000/login/callback/oidc
OIDC_CLIENT_ID=
OIDC_CLIENT_SECRET=
# Discovery document URL (e.g. https://dev-xxx.okta.com/.well-known/openid-configuration)
OIDC_DISCOVERY_URL=
# Display name for the login button (default: SSO)
OIDC_DISPLAY_NAME=SSO

# ===========================================================================
# Rate Limiting
# ===========================================================================

# slowapi rate limit string for the login endpoint.
# Format: "{count}/{period}" where period is second, minute, or hour.
LOGIN_RATE_LIMIT=10/minute

# ===========================================================================
# Registration
# ===========================================================================

# Allow new users to self-register (create accounts without admin invitation).
# Admin can also toggle this from the admin settings page at runtime.
# Set to false to restrict access to admin-created accounts only.
SELF_REGISTRATION_ENABLED=true
